import React from 'react';
import PropTypes from 'prop-types';
import { Box, Badge } from '@shopify/polaris';
import { MESSAGE_TYPES } from './constants';

function VulnerabilityBadge({ isVulnerable, type }) {
    const isRequest = type === MESSAGE_TYPES.REQUEST;

    // Only show badge for vulnerable responses
    if (!isVulnerable || isRequest) {
        return null;
    }

    return (
        <Box paddingBlockStart="2">
            <Badge status="critical">System Prompt Leak</Badge>
        </Box>
    );
}

VulnerabilityBadge.propTypes = {
    isVulnerable: PropTypes.bool,
    type: PropTypes.oneOf([MESSAGE_TYPES.REQUEST, MESSAGE_TYPES.RESPONSE]).isRequired,
};

VulnerabilityBadge.defaultProps = {
    isVulnerable: false,
};

export default VulnerabilityBadge;
